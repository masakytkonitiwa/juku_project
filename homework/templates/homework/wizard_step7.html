{% extends 'homework/base.html' %}
{% load static %}
{% load homework_extras %}
{% block title %}å®¿é¡Œç™»éŒ² Step 7{% endblock %}
{% block content %}

<!-- ã‚¹ãƒ†ãƒƒãƒ—ãƒãƒ¼ -->
<div class="arrow-steps">
  <div class="step done">1</div>
  <div class="step done">2</div>
  <div class="step done">3</div>
  <div class="step done">4</div>
  <div class="step done">5</div>
  <div class="step done">6</div>
  <div class="step current">7</div>
</div>




<h2 class="text-2_8rem">ç¢ºèªã¨ç™»éŒ²</h2>

<!-- ç™»éŒ²å†…å®¹ã®ç¢ºèª -->
<div class="text-2_8rem ">
  <p><strong>ç§‘ç›®:</strong> {{ subject }}</p>
  <p><strong>ã‚³ãƒ¼ã‚¹:</strong> {{ course }}</p>
  <p><strong>å•é¡Œã‚¿ã‚¤ãƒ—:</strong> {{ problem_type }}</p>
  <p><strong>å•é¡Œæ•°:</strong> {{ problem_count }}</p>
  <p><strong>å‘¨å›æ•°:</strong> {{ cycles }}</p>
</div>




<!-- å®¿é¡Œã®ç¢ºèª -->




<div class="mb-4">
  <div class="bg-white shadow-lg rounded-xl p-6 border border-gray-200">
    <div class="text-2_8rem text-gray-500 mb-4">å®¿é¡Œã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</div>
   
    {% for task in scheduled_tasks %} 
      <div class="text-2_8rem  font-semibold text-green-600 leading-snug">
      {{ task.date }}: {{ task.task }}
      </div>
    {% endfor %}

  </div>
</div>



<!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤º -->
<h3 class="text-xl my-6">æ—¥ä»˜ã‚’é¸æŠã—ãŸã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</h3>
<form method="post">
  {% csrf_token %}

  <input type="hidden" name="subject" value="{{ subject }}">
  <input type="hidden" name="course" value="{{ course }}">
  <input type="hidden" name="problem_type" value="{{ problem_type }}">
  <input type="hidden" name="problem_count" value="{{ problem_count }}">
  <input type="hidden" name="cycles" value="{{ cycles }}">
  <input type="hidden" name="selected_dates" id="selected_dates">







  <div class="calendar-wrapper-full">
    <div class="calendar-header">
      <div>æœˆ</div><div>ç«</div><div>æ°´</div><div>æœ¨</div><div>é‡‘</div><div>åœŸ</div><div>æ—¥</div>
    </div>
  
    <!-- ğŸ“Œ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æœ¬ä½“ -->
    <div class="calendar">
      {% for day in calendar_days %}
      {% with day_str=day|date:'Y-m-d' %}
          <div class="day {% if day in selected_dates %}selected{% endif %} {% if day == today %}today{% endif %}" data-date="{{ day_str }}">
            <div class="date-label">{{ day|date:"m/d D" }}</div>
  
            <!-- ã‚¤ãƒ™ãƒ³ãƒˆ -->
            {% for ev in events_by_day|get_item:day %}
              <div class="event-item">ğŸ“… {{ ev.name }}</div>
            {% endfor %}
  
            <!-- æˆæ¥­ -->
            {% for lesson in lessons_by_day|get_item:day %}
              <div class="lesson-item">ğŸ“ {{ lesson.subject.name }} / {{ lesson.course.name }}</div>
            {% endfor %}
  
            <!-- æ—¢å­˜å®¿é¡Œ -->
            {% for hw_entry in homeworks_by_day|get_item:day %}
              <div class="homework-box">
                {{ hw_entry.detail.homework.get_subject_display }}<br>
                ğŸ« {{ hw_entry.detail.get_course_display }} / {{ hw_entry.detail.get_problem_type_display }}<br>
                ğŸ“‹ {{ hw_entry.task }}
              </div>
            {% endfor %}
  
            <!-- ç™»éŒ²äºˆå®šã®å®¿é¡Œï¼ˆæœªç™»éŒ²ï¼‰ -->
            {% for task in scheduled_tasks %}
              
              {% if task.date|stringformat:"s" == day_str %}
                <div class="homework-box">
                  ğŸ“ {{ task.subject }} / {{ task.course }}<br>
                  {{ task.problem_type }}
                  {{ task.task }}
                </div>
              {% endif %}
            {% endfor %}
          </div>
          {% endwith %}

          <!-- 7æ—¥ã”ã¨ã«æ”¹è¡Œ -->
          {% if forloop.counter|divisibleby:7 and not forloop.last %}
            </div><div class="calendar">
          {% endif %}

      {% endfor %}
    </div> <!-- æœ€çµ‚ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡Œ -->
  </div>
  
  <!-- ç™»éŒ²ãƒœã‚¿ãƒ³ -->
  <div class="text-center mt-5xl mb-5xl">
    <button type="submit" class="next-button">
      ç™»éŒ²ã™ã‚‹
    </button>
  </div>


</form>



<!-- æˆ»ã‚‹ãƒœã‚¿ãƒ³ -->
<div class="text-center mt-5xl mb-10xl">
  <a href="{% url 'homework_wizard_step6' %}" class="back-button">
    â† æˆ»ã‚‹
  </a>
</div>


{% endblock %}
</body>